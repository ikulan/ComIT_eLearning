<div class="modal fade" id="coursesModal" tabindex="-1" aria-labelledby="coursesModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="coursesModalLabel">Browse Courses</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="coursesModalBody">
        <!-- Search bar -->
        <div class="input-group mb-3">
          <input id="courseSearchInput" type="text" class="form-control" placeholder="Search courses by name or number">
          <span class="input-group-text">
            <i class="fa fa-search search-icon"></i>
          </span>
        </div>

        <div class="container" id="coursesList">
          <!-- Course list will be injected here -->
          <div class="text-center">Loading...</div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  let searchTimeout;

  function loadCourses(search = "") {
    fetch(`/Admin/Courses/ListPartial?searchString=${encodeURIComponent(search)}`)
      .then(response => response.text())
      .then(html => {
        document.getElementById('coursesList').innerHTML = html;
      })
      .catch(error => {
        document.getElementById('coursesList').innerHTML = '<div class="text-danger">Failed to load courses.</div>';
      });
  }

  // Initial load when modal opens
  const modal = document.getElementById('coursesModal');
  modal.addEventListener('show.bs.modal', function () {
    loadCourses();
  });

  // Monitor user's typing
  document.getElementById('courseSearchInput').addEventListener('input', function () {
    clearTimeout(searchTimeout);
    const query = this.value;

    searchTimeout = setTimeout(() => {
      loadCourses(query);
    }, 300); // wait 300ms after typing stops
  });
</script>
